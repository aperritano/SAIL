{"version":3,"sources":["discussionService.spec.es6"],"names":["MockTeacherDataService","workgroupId","componentId","describe","DiscussionService","TeacherDataService","createComponentState","componentStateId","nodeId","componentStateIdReplyingTo","response","id","studentData","beforeEach","angular","mock","module","mainModule","name","inject","_DiscussionService_","it","componentState","hasStudentWork","componentStateHasStudentWork","expect","toEqual","spyOn","and","callFake","componentStates","postAndAllReplies","getPostAndAllReplies","length","alicePost1","alicePost2","bobPost1","alicePost3","getPostsAssociatedWithWorkgroupId"],"mappings":"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","file":"discussionService.spec.js","sourcesContent":["import angular from 'angular';\nimport mainModule from 'vle/main';\nimport 'angular-mocks';\n\nclass MockTeacherDataService {\n  constructor() {\n\n  }\n  getComponentStatesByWorkgroupIdAndComponentId(workgroupId, componentId) {\n    return [];\n  }\n  getComponentStatesByComponentId(componentId) {\n    return [];\n  }\n}\n\ndescribe('DiscussionService', () => {\n\n  let DiscussionService;\n  let TeacherDataService;\n  const createComponentState = (componentStateId, nodeId, componentId, componentStateIdReplyingTo, response) => {\n    return {\n      id: componentStateId,\n      nodeId: nodeId,\n      componentId: componentId,\n      studentData: {\n        response: response,\n        componentStateIdReplyingTo: componentStateIdReplyingTo\n      }\n    };\n  };\n\n  beforeEach(angular.mock.module(mainModule.name));\n\n  beforeEach(inject((_DiscussionService_) => {\n    DiscussionService = _DiscussionService_;\n    TeacherDataService = new MockTeacherDataService();\n  }));\n\n  it('should check that a component state does not have student work', () => {\n    const componentState = {\n      studentData: {\n        response: ''\n      }\n    };\n    const hasStudentWork = DiscussionService.componentStateHasStudentWork(componentState);\n    expect(hasStudentWork).toEqual(false);\n  });\n\n  it('should check that a component state has student work', () => {\n    const componentState = {\n      studentData: {\n        response: 'The sun generates heat.'\n      }\n    };\n    const hasStudentWork = DiscussionService.componentStateHasStudentWork(componentState);\n    expect(hasStudentWork).toEqual(true);\n  });\n\n  it('should get post and all replies with component id and component state id', () => {\n    const nodeId = 'node1';\n    const componentId = 'component1';\n    const componentStateId = 1;\n    DiscussionService.TeacherDataService = TeacherDataService;\n    spyOn(DiscussionService.TeacherDataService, 'getComponentStatesByComponentId').and.callFake(() => {\n      const componentStates = [\n        createComponentState(1, nodeId, componentId, null, 'Hello'),\n        createComponentState(2, nodeId, componentId, 1, 'World')\n      ];\n      return componentStates;\n    });\n    const postAndAllReplies = DiscussionService.getPostAndAllReplies(componentId, componentStateId);\n    expect(postAndAllReplies.length).toEqual(2);\n  });\n\n  it('should get posts associated with workgroup id', () => {\n    const nodeId = 'node1';\n    const componentId = 'component1';\n    const workgroupId = 1;\n    const alicePost1 = createComponentState(1, nodeId, componentId, null, 'Alice Thread');\n    const alicePost2 = createComponentState(2, nodeId, componentId, 1, 'Alice reply in Alice Thread');\n    const bobPost1 = createComponentState(3, nodeId, componentId, null, 'Bob Thread');\n    const alicePost3 = createComponentState(4, nodeId, componentId, 3, 'Alice reply in Bob Thread');\n    DiscussionService.TeacherDataService = TeacherDataService;\n    spyOn(DiscussionService.TeacherDataService, 'getComponentStatesByWorkgroupIdAndComponentId')\n        .and.callFake(() => {\n      const componentStates = [\n        alicePost1,\n        alicePost2,\n        alicePost3\n      ];\n      return componentStates;\n    });\n    spyOn(DiscussionService.TeacherDataService, 'getComponentStatesByComponentId')\n        .and.callFake(() => {\n      const componentStates = [\n        alicePost1,\n        alicePost2,\n        bobPost1,\n        alicePost3\n      ];\n      return componentStates;\n    });\n    const postAndAllReplies = DiscussionService.getPostsAssociatedWithWorkgroupId(componentId, workgroupId);\n    expect(postAndAllReplies.length).toEqual(4);\n  });\n\n});\n"]}